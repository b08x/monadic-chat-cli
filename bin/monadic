#!/usr/bin/env ruby

# frozen_string_literal: true

require_relative "../lib/monadic_gpt"
require_relative "../lib/chat"
require_relative "../lib/code"
require_relative "../lib/novel"

title = "/M/O/N/A/D/I/C/ /G/P/T/".center(40, " ")
version = "Version: #{MonadicGpt::VERSION}".center(40, " ")
padding = "".center(40, " ")

banner = <<~BANNER
  #{MonadicGpt::PASTEL.on_magenta.bold(padding)}
  #{MonadicGpt::PASTEL.on_magenta.bold(title)}
  #{MonadicGpt::PASTEL.on_magenta.bold(padding)}
  #{MonadicGpt::PASTEL.on_magenta(version)}
  #{MonadicGpt::PASTEL.on_magenta.bold(padding)}
BANNER

parameter = ""

loop do
  print TTY::Box.frame banner.strip
  parameter = MonadicGpt::PROMPT.select("Select app:", per_page: 5, cycle: true, default: 1) do |menu|
    menu.choice "#{MonadicGpt::BULLET} #{MonadicGpt::PASTEL.bold("Chat")}  - #{MonadicGpt::Chat::DESC}", "chat"
    menu.choice "#{MonadicGpt::BULLET} #{MonadicGpt::PASTEL.bold("Code")}  - #{MonadicGpt::Code::DESC}", "code"
    menu.choice "#{MonadicGpt::BULLET} #{MonadicGpt::PASTEL.bold("Novel")} - #{MonadicGpt::Novel::DESC}", "novel"
    menu.choice "#{MonadicGpt::BULLET} #{MonadicGpt::PASTEL.bold("Quit")}  - Quit the app", "exit"
  end

  case parameter
  when "chat"
    MonadicGpt::Chat.new.run
  when "code"
    MonadicGpt::Code.new.run
  when "novel"
    MonadicGpt::Novel.new.run
  when "exit"
    print "Bye!\n"
    exit
  end
end
